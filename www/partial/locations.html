<ion-view ng-controller="manageLocationsCtrl">

<style>
.item {clear:both;}
.button {float:right;}
</style>

  <ion-header-bar class="bar-positive">
    <h1 class="title">จัดการพื้นที่สำรวจ</h1>
    <button id="logoutbt" ng-click="signOut()" class="button button-dark">
      Sign out
    </button>
  </ion-header-bar>

<ion-content class="has-footer has-header" on-swipe-left="goNext('/managejobs')">

  <ion-list ng-repeat="(key, value) in data | groupBy: 'province'">
    
    <ion-item>
      {{ key }}  
        <button class="button button-small" ng-click="showEditProvPopup(key);">
          <i class="icon ion-edit"></i>
        </button>

      <ion-item ng-repeat="(key, group) in value | groupBy: 'area'" class="item-stable" ng-click="toggleGroup(key, group)" ng-class="{active: isGroupShown(group)}" item="group" class="item-remove-animate" style="padding: 0px;">
        <span style="display: inline-block;padding: 1em;">{{ key }}</span>
          <button class="button button-small" ng-click="showEditAreaPopup(group[0].province, key);$event.stopPropagation();" style="margin: 0.5em;">
            <i class="icon ion-edit"></i>
          </button>
        <ion-item ng-repeat="item in group | orderBy:'pin'" class="item-accordion" ng-show="isGroupShown(group)||onEditGroup(key)" ng-click="$event.stopPropagation();">

        <div style="width:100%;">
          <div style="width:25%; display:inline-block; margin-right: 5%;">
            {{ item.pin }}       
              <button class="button button-small" ng-click="showEditPinPopup(group[$index].province, group[$index].area, item.pin)">
                <i class="icon ion-edit"></i>
              </button>
          </div><div style="width:70%; display:inline-block;"><span style="display:inline-block;width:78%;overflow: hidden;text-overflow: ellipsis;line-height: 1.5em;direction:rtl;text-align:left;">Lat : {{item.lat}}</span><button class="button button-small" ng-click="showEditLatPopup(group[$index].province, group[$index].area, item.pin, item.lat)" style="margin: 0 0.25em;">
                  <i class="icon ion-edit"></i>
              </button>
          </div>
        </div>

        <div style="width:100%;">
          <div style="width:30%; display:inline-block;"></div><div style="width:70%; display:inline-block;">
            <span style="display:inline-block;width:78%;overflow: hidden;text-overflow: ellipsis;line-height: 1.5em;direction:rtl;text-align:left;">Lng : {{item.lng}}</span>
              <button class="button button-small" ng-click="showEditLngPopup(group[$index].province, group[$index].area, item.pin, item.lng)" style="margin: 0 0.25em;">
                <i class="icon ion-edit"></i>
              </button>            
          </div>
        </div>
  
        </ion-item>
      </ion-item>
    </ion-item>
  </ion-list>

</ion-content>

<ion-footer-bar align-title="left" class="bar-positive">
  <button class="button button-full button-positive" ng-click="showAddProvPopup()" style="z-index: 2;">
    <i class="material-icons">add_circle</i> เพิ่มข้อมูล
  </button>
</ion-footer-bar>


<script id="AddProvPopup.html" type="text/ng-template">
	<!-- <input ng-model="AddProvData.provInTxt" type="text" placeholder="Add Province"> -->
  <select style="width: 100%; padding: 0.5em;" ng-model="AddProvData.provInTxt" ng-change="filterArea()">
    <option value="" disabled selected>เลือกจังหวัด</option>
    <option ng-repeat="prov in queryProv | orderBy">{{prov}}</option>
  </select>
  <!-- <input ng-model="AddProvData.areaInTxt" type="text" placeholder="Add Area"> -->
  <select style="width: 100%; padding: 0.5em;" ng-model="AddProvData.areaInTxt">
    <option value="" disabled selected>เลือกพื้นที่</option>
    <option ng-repeat="area in queryArea | orderBy">{{area}}</option>
  </select>
  <input ng-model="AddProvData.pinInTxt" type="text" placeholder="Add Pin">
  <input ng-model="AddProvData.latInTxt" type="text" placeholder="Add Latitude">
  <input ng-model="AddProvData.lngInTxt" type="text" placeholder="Add Longtitude">
</script>








<script id="EditProvPopup.html" type="text/ng-template">
	<input ng-model="EditProvData.provInTxt" type="text" placeholder="Edit Province">
</script>
<script id="EditAreaPopup.html" type="text/ng-template">
	<input ng-model="EditAreaData.provInTxt" type="text" placeholder="Edit Area">
</script>
<script id="EditPinPopup.html" type="text/ng-template">
	<input ng-model="EditPinData.pinInTxt" type="text" placeholder="Edit Pin">
</script>
<script id="EditLatPopup.html" type="text/ng-template">
	<input ng-model="EditLatData.pinInTxt" type="text" placeholder="Edit Latitute">
</script>
<script id="EditLngPopup.html" type="text/ng-template">
	<input ng-model="EditLngData.pinInTxt" type="text" placeholder="Edit Longtitute">
</script>  
  



</ion-view>


